#!/usr/bin/env bash
# Wrapper script for llm-pipeline CLI
# Ensures Python virtual environment is present and then invokes the Typer app.
# Auto-generated by Copilot assistant.

set -euo pipefail

SCRIPT_DIR="$(cd "$(dirname "${BASH_SOURCE[0]}")" && pwd)"
REPO_ROOT="$(cd "${SCRIPT_DIR}/.." && pwd)"
TOOL_NAME="src.pipeline.cli.main" # Name of the Typer app module
export BZL_VENV="${REPO_ROOT}/venv"

# Source logging utilities
UTILS=("logging" "python_env")
ENV_UTILS_DIR="${REPO_ROOT}/libs/envutils/bash"
for util in "${UTILS[@]}"; do
    [ -f "${ENV_UTILS_DIR}/${util}" ] && { # shellcheck disable=SC1090
        # shellcheck disable=SC1090
        source "${ENV_UTILS_DIR}/${util}"
        echo "Sourced ${util} utilities"

    } || {
        echo "[ERROR] ${util} utilities not found;"
        return 1
    }
done
venv_setup
# Initialize PYTHONPATH if not set
export PYTHONPATH="${REPO_ROOT}/src:${PYTHONPATH:-}"
exec "${BZL_VENV}/bin/python" -m $TOOL_NAME "$@"
